import{d as B,p as _,A as $,x as D,c as w,o as f,h as I,b as n,a as r,u as a,w as l,e as i,F as P,r as U,f as R,t as u,B as M,W as j}from"./app-CH-AyX6Z.js";import{_ as C}from"./index-FO0kJPJg.js";import{_ as c}from"./Input.vue_vue_type_script_setup_true_lang-C8m6OWIf.js";import{_ as d,a as b}from"./InputError.vue_vue_type_script_setup_true_lang-D4KKi0iW.js";import{_ as L}from"./Checkbox.vue_vue_type_script_setup_true_lang-DalQi_qj.js";import{_ as S,a as T,b as q,c as E,d as W}from"./SelectValue.vue_vue_type_script_setup_true_lang-BGdhUJe8.js";const G={class:"border-b pb-6"},H={class:"space-y-4"},J={class:"flex items-center space-x-2 pt-2"},K={class:"mt-4 space-y-2 rounded-lg border bg-gray-50 p-3 text-sm"},Q={class:"flex justify-between"},z={class:"font-medium"},O={class:"flex justify-between"},X={class:"font-medium"},Y={class:"flex justify-between border-t pt-2 mt-2 font-bold text-base"},Z={class:"text-[#F08519]"},re=B({__name:"DonationForm",props:{programId:{},fees:{}},setup(A){var V,k;const y=A,g=_(()=>$().props.auth.user),t=D({program_id:y.programId,amount:5e4,donator_name:((V=g.value)==null?void 0:V.name)??"",donator_email:((k=g.value)==null?void 0:k.email)??"",message:"",is_anonymous:!1,payment_method:"bri_va"}),v=_(()=>{const s=y.fees[t.payment_method],e=Number(t.amount)||0;if(typeof s=="number")return s;if(typeof s=="string"&&s.includes("%")){const o=parseFloat(s.replace("%",""));return isNaN(o)?0:Math.ceil(e*o/100)}return 0}),h=_(()=>(Number(t.amount)||0)+v.value),p=s=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(s),x={bri_va:"BRI Virtual Account",bni_va:"BNI Virtual Account",bca_va:"BCA Virtual Account",echannel:"Mandiri Virtual Account",permata_va:"Permata Virtual Account",cimb_va:"CIMB Virtual Account",other_qris:"QRIS",gopay:"GoPay",shopeepay:"ShopeePay"},N=s=>s?x[s]?x[s]:s.replace(/_/g," ").toUpperCase():"",F=()=>{t.processing=!0,M.post(route("donations.store"),t.data()).then(s=>{const{redirect_url:e,order_id:o}=s.data;e&&o?(window.open(e,"_blank"),t.reset(),j.visit(route("donations.status",{donation:o}))):alert("Tidak bisa mendapatkan URL pembayaran.")}).catch(s=>{var e,o,m;((e=s.response)==null?void 0:e.status)===422?t.errors=s.response.data.errors:alert(((m=(o=s.response)==null?void 0:o.data)==null?void 0:m.error)||"Terjadi kesalahan pada server.")}).finally(()=>{t.processing=!1})};return(s,e)=>(f(),w("form",{onSubmit:I(F,["prevent"]),class:"space-y-6 rounded-xl border bg-white p-6 shadow-md"},[n("div",G,[e[14]||(e[14]=n("h3",{class:"font-semibold mb-4 text-lg text-center"}," Salurkan Kebaikan Anda",-1)),n("div",H,[n("div",null,[r(a(d),{for:"amount",class:"mb-2"},{default:l(()=>e[5]||(e[5]=[i("Jumlah Donasi")])),_:1,__:[5]}),r(a(c),{id:"amount",type:"number",placeholder:"Rp 50.000",modelValue:a(t).amount,"onUpdate:modelValue":e[0]||(e[0]=o=>a(t).amount=o),required:"",class:"text-center text-lg font-bold"},null,8,["modelValue"]),r(b,{message:a(t).errors.amount,class:"mt-1"},null,8,["message"])]),n("div",null,[r(a(d),{for:"donator_name",class:"mb-2"},{default:l(()=>e[6]||(e[6]=[i("Nama Anda")])),_:1,__:[6]}),r(a(c),{id:"donator_name",type:"text",placeholder:"Nama Lengkap",modelValue:a(t).donator_name,"onUpdate:modelValue":e[1]||(e[1]=o=>a(t).donator_name=o),required:""},null,8,["modelValue"]),r(b,{message:a(t).errors.donator_name,class:"mt-1"},null,8,["message"])]),n("div",null,[r(a(d),{for:"donator_email",class:"mb-2"},{default:l(()=>e[7]||(e[7]=[i("Email Anda")])),_:1,__:[7]}),r(a(c),{id:"donator_email",type:"email",placeholder:"email@anda.com",modelValue:a(t).donator_email,"onUpdate:modelValue":e[2]||(e[2]=o=>a(t).donator_email=o),required:""},null,8,["modelValue"]),r(b,{message:a(t).errors.donator_email,class:"mt-1"},null,8,["message"])]),n("div",null,[r(a(d),{for:"payment_method",class:"mb-2"},{default:l(()=>e[8]||(e[8]=[i("Metode Pembayaran")])),_:1,__:[8]}),r(a(S),{modelValue:a(t).payment_method,"onUpdate:modelValue":e[3]||(e[3]=o=>a(t).payment_method=o)},{default:l(()=>[r(a(T),null,{default:l(()=>[r(a(q),{placeholder:"Pilih metode..."})]),_:1}),r(a(E),null,{default:l(()=>[(f(!0),w(P,null,U(s.fees,(o,m)=>(f(),R(a(W),{key:m,value:m},{default:l(()=>[i(u(N(m)),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),n("div",J,[r(a(L),{id:"is_anonymous",checked:a(t).is_anonymous,"onUpdate:checked":e[4]||(e[4]=o=>a(t).is_anonymous=o)},null,8,["checked"]),r(a(d),{for:"is_anonymous",class:"text-sm font-normal"},{default:l(()=>e[9]||(e[9]=[i("Donasi sebagai Hamba Allah")])),_:1,__:[9]})]),n("div",K,[n("div",Q,[e[10]||(e[10]=n("span",{class:"text-gray-600"},"Donasi",-1)),n("span",z,u(p(Number(a(t).amount)||0)),1)]),n("div",O,[e[11]||(e[11]=n("span",{class:"text-gray-600"},"Biaya Transaksi",-1)),n("span",X,u(p(v.value)),1)]),n("div",Y,[e[12]||(e[12]=n("span",null,"Total Pembayaran",-1)),n("span",Z,u(p(h.value)),1)])]),r(a(C),{type:"submit",class:"w-full h-12 text-lg bg-[#F08519] text-white hover:bg-[#F08519]/90",disabled:a(t).processing},{default:l(()=>e[13]||(e[13]=[i("Lanjutkan Pembayaran")])),_:1,__:[13]},8,["disabled"])])])],32))}});export{re as _};
